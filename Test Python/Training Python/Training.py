import numpy as np
import neurolab as nl

# Create train samples
input = np.array ([[151.436, 87.7992, 108.648],
                     [125.626, 84.2045, 93.9942],
                     [137.888, 86.6625, 104.052],
                     [142.886, 97.3188, 114.559],
                     [134.606, 92.4286, 97.6189],
                     [127.808, 89.6326, 94.4606],
                     [146.566, 103.691, 120.838],
                     [136.047, 94.8274, 99.66],
                     [122.61, 134.982, 91.2794],
                     [129.617, 138.273, 99.5434],
                     [115.531, 122.718, 83.7302],
                     [116.46, 107.925, 81.3734],
                     [131.493, 107.948, 96.4894],
                     [125.158, 95.5377, 86.829],
                     [114.709, 98.685, 84.3805],
                     [129.893, 104.846, 100.337]])

target = np.array ([   [1, 0],
                       [1, 0],
                       [1, 0],
                       [1, 0],
                       [1, 0],
                       [1, 0],
                       [1, 0],
                       [1, 0],
                       [0, 1],
                       [0, 1],
                       [0, 1],
                       [0, 1],
                       [0, 1],
                       [0, 1],
                       [0, 1],
                       [0, 1]])

# Membuat JST 2 layer => 3 Input dan 2 Output
net = nl.net.newlvq(nl.tool.minmax(input), 4, [.8, .2])

# Training
error = net.train(input, target, show=1, epochs=100, goal=0.001, lr=0.05)

test = net.sim ([[151.436, 87.7992, 108.648],
                     [125.626, 84.2045, 93.9942],
                     [137.888, 86.6625, 104.052],
                     [142.886, 97.3188, 114.559],
                     [134.606, 92.4286, 97.6189],
                     [127.808, 89.6326, 94.4606],
                     [146.566, 103.691, 120.838],
                     [136.047, 94.8274, 99.66],
                     [122.61, 134.982, 91.2794],
                     [129.617, 138.273, 99.5434],
                     [115.531, 122.718, 83.7302],
                     [116.46, 107.925, 81.3734],
                     [131.493, 107.948, 96.4894],
                     [125.158, 95.5377, 86.829],
                     [114.709, 98.685, 84.3805],
                     [129.893, 104.846, 100.337]])
print (test)